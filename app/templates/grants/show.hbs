<h2>Grant details</h2>

<ul>
  <li>Funder: {{model.funder.name}}</li>
  <li>Award Number: {{model.awardNumber}}</li>
  <li>Project Name: {{model.projectName}}</li>
  <li>PI: <a href='mailto:{{model.pi.email}}'>{{model.pi.name}}</a></li>
  <li>CoPIs:</li>
    <ul>
      {{#each model.copis as |person|}}
        <li><a href='mailto:{{person.email}}'>{{person.name}}</a></li>
      {{/each}}
    </ul>
  <li>Start: {{date-formatter model.startDate}}</li>
  <li>End: {{date-formatter model.endDate}}</li>
  <li>Status: {{model.status}}</li>
  <li>OAP Compliance: {{model.oapCompliance}}</li>
  <li>Created by: {{model.creator.username}} on {{date-formatter model.creationDate}}</li>
</ul>


<h3>Submissions of grant</h3>

{{models-table
  data=model.submissions
  columns=columns
  themeInstance=themeInstance
  showColumnsDropdown=false
  filteringIgnoreCase=true
  multipleColumnsSorting=false
}}

{{#if isShowingForm}}
    {{#modal-dialog translucentOverlay=true}}
      {{#workflow-group name="overview" as |group|}}
        {{#workflow-card step="doi" group=group
            cancel=(action (queue 
                (action "cancelSubmission") 
                (action (mut isShowingForm) false)
            )) 
            save=(action (queue
              (action "saveSubmission")
              (action (mut isShowingForm) false)
            ))
            continue=(action "advance" target=group)}}
          {{submission-overview-doi submission=newSubmissionObject}}
        {{/workflow-card}}
      
        {{#workflow-card step="details" group=group
            cancel=(action (queue 
                (action "cancelSubmission") 
                (action (mut isShowingForm) false)
            ))
            save=(action (queue
              (action "saveSubmission")
              (action (mut isShowingForm) false)
            ))
            continue=(action (queue
                (action "advance" target=group)
                (action "save" target=group)
                (action "attachWorkflow" group.workflow)
                (action "saveSubmission")
                (action (mut isShowingForm) false)
                (route-action "transitionTo" "submission.show.index" newSubmissionObject)
            ))}}
          {{submission-overview-details submission=newSubmissionObject}}
        {{/workflow-card}}

        {{#workflow-card step="view" group=group}}
          Saving submission...
        {{/workflow-card}}

      {{/workflow-group}}
   {{/modal-dialog}}
{{/if}}
<button class="btn btn-primary btn-small" onclick={{action (queue
      (action "newSubmission") 
      (action (mut isShowingForm) true)
      )}}>
  New Submission
</button>

{{#link-to 'grants' class="btn btn-primary btn-small"}}Back to grants{{/link-to}}
